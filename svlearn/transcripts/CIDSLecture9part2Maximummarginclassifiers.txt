 Let's come to an interesting classifier. To motivate this classifier, I'll take an example. See, I come from the ancient city of Varanasi or or Benares, or Kashi, or Sarnath. Have you heard of these cities? Most of you would have, right? It has many names, Varanasi, Kashi, Sarnath, Benares, right? And so and so forth. It is on the banks of a river. It's supposed to be, there's something very interesting about the city I come from. It is actually, to my knowledge, is the oldest living city in the world. You have had cities, for example, in ancient Egypt, but they have all been destroyed. The Mesopotamian cities, the civilian cities would get destroyed and they'll become dust. But Banaras is the oldest continuous living civilization so far. And even today, if you walk the streets of Benares, you'll find people of all sorts of persuasions and beliefs. It is also the sacred place for many religions. It's sort of like Jerusalem. Many religions in the Middle East hold it sacred, so Benares is like that. And a lot of, you find people running, holding mobile phones and, you know, very modern looking young people, or you could, you could see people who still adhere to practices before the metal age, before the iron age. They will not touch anything of metal. They will eat and do all their things with earthen pots. So you see a kaleidoscope of cultures that India has been through. You can see India's history sort of written there. So anyway, that's a little digression about the city I come from. Now, it has a river going through it. i come from now it has a river going through it the river has an interesting quality this river is let's say i will call this river this is the ganga also called ganges here right ganga or ganges and obviously in many traditions, river is held sacred. So now this river, it goes through the city. When it goes through the city, you observe something fairly interesting. And I've taken a small section, straight section of the river here, right? Is that the houses here, right? So I'll just mark the houses with triangles. There are all sorts of houses here, lots of houses on one side. If you ever just Google up a picture, just please, if you're on your laptop, just look up picture of the Varanasi Ghat, or Banaras Ghat, G-H-A-T. Are you able to see a picture of that? And you will see that on one side of the river, you have a complete jam pack of buildings, temples and things like that. Anybody seeing that? Maybe I'll show this. Yeah, yeah, it's a Yeah, yeah, it's been that I've been there. I think Yeah, I've taken a ride on on the Ganges. Yeah, cards. So, yes, I will bring this thing here for a moment. Do you notice that all of these buildings are jam packed next to the river? But what you don't see so clearly is the other side of the river. On the other side, let me see if there's any picture of the other side of the river, none. Oh yes, here it is, the other side of it. Look at the other side. Do you notice that it's agricultural land? Can you see where the sun, below the sun? It's hard to make out, but you don't see the clutter of buildings there anymore. So it is a remarkable thing. And anyway, this is a motivating example for this, but I thought this will give you a strong intuition on what we are doing. It's a remarkable thing that on the other side, find predominantly agricultural trees trees and agriculture right so i hope this looks sufficiently like a tree and can you explain why is it that on one side, everybody chose to build buildings on one side of a river and not the other? This, by the way, is very common. Whenever you look at rivers, very, very often you'll find buildings and a city on only one side of the river. And agricultural land on the other side. Can you guess why that is? I think because of flooding. That is true. But flooding can be on both sides. Why does flooding preferentially pick one side? Depends on how steep the banks are. And what makes one bank steeper than the other? Being prone to erosion or other geological yes you're getting close uh prentice the sea is on one side well we are far from the sea and uh the river has a drift due to the rotation of the earth on one end. Yes, that is right. Who said that? I didn't recognize the words. Who said that? Sorry. Abhishek. Abhishek. You're absolutely right, Abhishek. So there is a thing in the sphere of the earth that earth, as it spins about its axis, it creates a force called the Coriolis force. What the Coriolis force does is it makes the rivers drift in one particular direction. They will all migrate. So as they migrate, what happens is if they move in this direction so suppose the river was here and now the river is here they have gradually drifted so they have left a gentle slope here and on this side the land is well obviously it was high enough because that's why it wasn't the river so it is cutting into the banks here the steep bank here that is why most rivers you'll find a steep bank on one side and a gradual bank on the other side right and what happens in india especially is that the ganges will flood when when the water rises it will go and flood the smooth side and as it floods the smooth side will of course it will leave behind it will bring very very fertile alluvian soil with it and when the flood recedes you you get essentially nature's gift of fertilizer extremely fertile soil on which you don't have to do anything you can plant your crops okay so you have agriculture. Anyway, so what has that to do with support vector machines? Let's come and see. After this digression, what does it mean? So we realize that we have two sides. Now I'll ask you a question, that suppose I give you a point in space. So now let's put a sort of a coordinate, XY coordinates here xy, x1, x2, direction x1, right? We have a coordinate system. You can place your coordinate system wherever you like. I ask you, given a point in space, let this point be here. Do you see houses there or do you see trees there? What would you answer? Houses. That points to houses. Right. And if I were to give A and I were to give B, a point B, you would say it is trees. So one region is predominantly houses houses the other region is trees very simple situation and do you notice that there is nothing in between just the water flows in between right when you have a situation like this and now comes the puzzle suppose you couldn't see the river. Your data is like this. The two types will, whenever you think of your blueberries and cherries, remove the blue, think houses in, for this example, think houses and trees suppose data came to you like this oh sorry uh which color did i use this color data came to you like this and you were you were asked to make a decision boundary how many what what sort of decision boundaries can you make what would be a decision boundary would you agree that this would be a pretty good this would work separating out the houses from the trees let me call this alpha another decision boundary can be straight line could be beta we and right and one way to think of it is think of the decision boundary as the center of the river you're trying to flow a river through it. So you can see the river, but you're looking at it right, you can flow the river either like alpha you can flow the river either like beta or you could flow the river like. Something. like something, gamma. Now, which of these three rivers would you prefer? Gamma. And why would you prefer that? Because it's got the most margin on both sides of it from the trees and the houses. That's right. So see, the intuition is that this is a sample data, it is quite possible that another sample of the data might have put a house. See right here. And what has it done to your classifier, it has messed up your classifier a tree here right so just another sample of data where which is essentially the same data can disrupt alpha and beta but that can be outliers right not necessarily they are inline points you take a different set of data you may have a different you may have a different house sticking out, right? So the idea is, okay, let me illustrate it to the point. Suppose there is one house here and all other houses are like this, right? And some house like this, they're jagged. They're not all in a straight line. Likewise, so what happens is that you you you have to be careful because so here's the thing i'll make one more house here right right you don't want to suppose in the first sample of data this was not there this one was not there would you agree that you could you could have made a decision boundary like this this is your alpha if this guy was not there it would be it it just so happens you took a different sample of data and now that point showed up right so in a way you should anticipate points in the neighborhood of points is that a reasonable thing? That whenever you have sample of data, you can imagine that in the population, there is a greater chance of some houses being here where I'm drawing them rather than being here. So let me just call this. Do you see these points? Would you agree that if you take a different sample of data you might have ended up with these points as opposed to this point which is far from the houses does that agree with your intuition guys right so if it agrees what you are saying is that if this is less likely let us leave a little cushion from the data points. Let's make the center of the river go with a slight cushion. In other words, let the river be wide, isn't it? So what is that river that you can flow through it that is the widest river that gives the maximum question between the decision boundary and the points it would be the point it would be the decision boundary that is farthest from the points would you agree Do you agree? So pay attention to what I just said. I'm saying that the virtue of gamma is that it is far away from the trees in the houses. Isn't it? Whereas alpha and beta, they come dangerously close at some point to the trees in the houses. Am I making sense, guys? Please give me some feedback. Yeah, this is straightforward, right? And so what you say that if I want to flow a river, you're much better flowing it for as far away as possible. Now, what you do is, if you do this, pick the point, pick the house that is closest to the decision boundary. Let us say that it is this house. These houses, these three houses. What you do is you draw this line that goes through the nearest points to the decision boundary. And in terms of tree, let us say that there is a tree here, which is the closest tree. Maybe I'll deliberately plant one tree here, right? So then the closest tree that you can have, or the margin that you can have going through, no, this is not a good one. This is, would you agree? These two blue lines are go through the nearest points to the decision boundary. Right. These points are called these are the margins. These two are the river banks, isn't it? Because if houses are sitting on the river, you would agree that that would be the river bank. Would you agree? Right? The end of the water, the end of the river has to be the blue lines. Because you know, that after that it's water and houses don't grow in water. So far so good. So there is a name for it. So now what happens is, so one easy intuition is, suppose you were a boatsman. You are a boatsman and I'll use this analogy again and again. So be with me. Imagine that you're rowing your boat in the that in the night the you are trying to find and not get stuck on the banks because then your boat will capsize you are trying to make your way through you would like to stay away from both the trees and the houses isn't it as far as away as possible so what is the path that you will draw in? You will row your boat along gamma. Isn't it? The path that the boatsman will take to navigate is essentially a decision boundary. Now, how will you take? You would say for the boatsman, suppose these houses, they would say that what is most helpful to me in drawing is that if only these houses were lit up they were lighthouses right in some sense if only they had their lights on and i could see them isn't it are we together does it make sense because if at night i can see them i know i can draw a line through them and know okay that is one margin one river bank likewise if this tree could begin to light up this big tree somehow became a christmas light christmas lit tree big christmas tree make Christmas tree. Oh, lovely. Then it is very easy to row through the center of the river. Isn't it? So I'm bringing in the concept of a boatsman. And see, this is a bit mathematical. People usually put it in very mathematical jargon in your books everywhere. But I like to make it more real. So imagine that you're a boatsman. We'll come to that. Hold that thought in your mind. Rowing the boat, right? A boatsman rowing the boat. We also need lighthouses. Lighthouses on the banks to navigate this is common sense guys so far does it agree with your intuition that's what you would do sonal go ahead That's what you would do. Sonal, go ahead. Boatsman having a? We are not allowing him to have a flashlight. He's a pirate. You don't want him to be visible. All right. So boatsman is not allowed okay now so if you get this concept so the smartest path would you agree that the smartest path is test but for the boatsman is to row as far away from the banks as possible. Isn't it? In other words, that it will be exactly in the middle of the two margins. Right? And the river that you flow, you want the margins, you want to flow that river that has the widest river that you can flow. Because if on the same data, so let's again go and pretend that, let's redraw this data, but I'll make a more abbreviated version of this data. Suppose it is here. And once again your trees are here. So see here's the thing. If you flow this river like this. Oh sorry. If you flow your river like this you know that this is bad isn't it it is bad because your river is too narrow right and you know that your decision boundary is too close to the points. It is much harder to navigate this river than to navigate a wider river. Would you agree? Right? You're much more likely to hit the banks. So that's your basic intuition. You want to, the goal is, the optimal solution is, right? The question is, intuitively, we want to flow the widest river through the data, through the data for the boat to be safe, to be safely navigating. So far and the path, the other part we say that now let's convert this intuition into formal language the boatsman boats part is the decision boundary anything on one side of it is houses anything on the other side will can be declared as trees you agree with that? The riverbanks banks are formally called margins. So what are margins? Margins are lines or hyperplanes that sit upon the nearest points to the decision boundary, isn't it? does that make sense guys the margins are margin is this blue these blue lines which are going through those in effect the lighthouses right those houses that help define the margin the cl these are the closest to the hyperplane to the sorry to the decision boundary does that make sense guys am i am i making sense on each side find the closest point to the decision boundary and those are your houses and of course that's how it is if you look at the picture to get an intuition let's go back and look at this picture suppose oh look at this picture. Suppose, oh, look at this picture. Wow. So you look at this picture, would you literally see lighthouses? Yes. Helping you along at night if you're boating in the dark. So this is it. This is your concept. Yes, helping you along at night if you're boating in the dark. So this is it. This is your concept you to navigate you just need to have a few lighthouses on the banks of the river, and there is a name for this lighthouses. The lighthouses Houses are called, anybody can guess? Not prior students, new students. These are called the support vectors. They guide you. They guide you navigate the river in the dark. Right. So I'm giving you an intuition. And now can you sort of guess metaphorically why I named this company support vectors? Lighthouse beacon. These are the lighthouse beacons exactly that I want this place to be the lighthouse beacon. These are the lighthouse beacons, exactly. I want this place to be the lighthouse beacon for us to learn. You guide. That's it? You guide. You guide, exactly. So if you were the boatsman, then support vectors would be the lighthouse that you would need to navigate. So this is it. So what we learned is these are called maximal. There's a name for this. And let's see if this word makes sense. Maximal margin hyperplane. Maximal margin classifier. Hyperplane is implicit. Hyper classifier. So in other words, this is the classifier where maximal, of course, in simple terms, in simple terms, flow the widest river through the data. Are we together right remember the definition of margin is points going through the i mean the the line going through the lighthouses now how many points do you need to determine the lighthouse to get a point right see you need to get one line right at least right because if i give you two points can you determine what the you can't, you probably need one more as a lighthouse. Right. And then the other one will be parallel to it. So you need about three points to support vectors. Before you get there. are situations where you can say hey every other river that i flow through this right does not have as much margin and i can get away with two points but in practical terms you'll notice that when you solve your problem you will have three or more points most of the time as support vectors but there is something very remarkable about this maximal so now this very formal term does it make sense guys the reason i'm mentioning it is typically uh most literature on support vector machines can get quite mathematical and i've brought the mathematics hopefully down to an intuitive level anybody wants me to review it so far simple right now observe a characteristic of this maximal margin classifier, do you notice that the decision boundary is completely unaffected by any points except the lighthouses? Is that obvious? It doesn't matter. For example, if this point, you move to this point, do you think your decision boundary will change? No, right? to this point do you think your decision boundary will change no right and suppose you put an outlier here far off do you think still your decision boundary will change no decision boundary is completely determined by inliner points isn't it in fact very few points so that is the virtue of a maximal margin hyperplane. It is insensitive to outliers. Do you see that? Which is a huge virtue. If you remember linear classifiers and linear methods, linear regression, logistic classifier, they were all hostage to outliers, isn't it? If you had outliers, they would have influence so let's write down its virtue depends only on lighthouses, right? Lighthouses, which are few. A few in liner points. And the most important thing, completely And the most important thing, completely unaffected by outliers. That's quite a virtue, isn't it, compared to linear methods? Right. And at the end of the day, what is your model? Once the learning of the lighthouse has been done, what do you need to store? What exactly do you need to know the to redraw the decision boundary? Just the support vector. So model is a very simple model. The model learned is just a small set of lighthouses support vectors. Just a small set of lighthouses, isn't it? Because if I tell you that you need this, this is a lighthouse, this is a lighthouse, and this is a lighthouse. Do you think you can draw the decision boundary? Easily, because what you would do is you would say, hey, here is my margin and parallel to it, here is my margin. And so where can the decision boundary be? In between, exactly the median of it. The median going through these two margins is the decision boundary. Go ahead, Sonia. So rather than outliers being high-levels, they are not high-levels? Instead of the outliers being high influence, what's your question? Inliners. The lighthouses are, yes. So if you take a different sample of the data, it may have different lighthouses, it may draw. But generally what happens is inliner data tends to be dense. So the other lighthouse will be very close. The next sample of data you take, it will be very close to the other one. So you will end up with pretty much the same river right which is the virtue of these methods right so what happens is this may move a little bit or is the direction may change just a tiny little bit based on the new lighthouses that you discover but it doesn't change much right go ahead go ahead intuition was fine but when you summarize it with three support vectors and you're able to draw two battle lines to three support vectors yes there is an extra piece of information that you're using which is an intuition on which side you don't see yeah because I cannot draw I have to draw the maximal margin the widest river if i try to flow any other river let's try to flow any other river let's say i try to flow this river now which is wider the one with blue blue margins or the one with pink margins The one with blue margins or the one with pink margins? That's the inherent thing. Inherent thing, yeah. So that is the meaning of the word maximal. Maximal margin, right? And so you just need to store those support vectors, and then you can find your decision boundaries in no time. Are we together? Now observe something very interesting here. Suppose these lighthouses are there. Let me call the lighthouse X is at position XA, XB and X. So by the way, can I erase? So let me redraw this. I'll remove the pink lines. Let me redraw this picture Raja Ayyanar?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam?nilam make the river bank still. Yeah, so suppose I have this, I'm just going to recreate it. These are your lighthouses. And obviously this lighthouse is a tree, is a house, and this is a house, and this is a tree. Suppose I ask you, given these, can you tell me you have flown the river? Suppose I have a point, a point, let me say X, X point, where I want to attest point x. And I want to find out, is it a house or is it a tree? Right? And let me just draw the decision boundaries here. Right? I want to find that out. So one way you could do it is you could find the decision boundary, find its beta naught, you know, that you could actually go find the decision boundary first, draw the decision boundary, and then see which side of the decision boundary are you on? What is your distance from the decision boundary, right? In other words, you could do this equation, x to distance of x from the decision boundary. If it is greater than equal to zero, less than equal to zero, what is it? Am I making sense? What we have learned so far is first you draw the decision boundary and then you decide where it is. But I'm going to mention something a little bit clever. See what happens if I take, if I tell you that X and X, let me call it A, B and C, XA, I give you this, the dot product is known right if a dot dot product is known and the dot product of x xb is known and x with xc that the three dot products are known what can you tell if you know the dot products? See, dot product is from the origin, from some coordinate system. It is a measure of both the distance as well as this angle, theta 1, isn't it? How much both points are traveling uh together that is right theta 2 and theta 3 uh theta 3 and the distance 3. now think about it this way given the dot product the only thing left to determine is what are the magnitudes and the thetas like it says something about the magnitude and theta isn't it right suppose i know the size of x the size of a right it pretty much constrains me to a certain angle here are we together if i say that i know that XA is size one, right? So this is equal to what? X, XA, cosine theta one, right? Likewise for the other one. So I know this. Let's suppose I just happen to know this, right? I happen to know this. Now, what remains? I know the cosine of theta one from the dot product isn't it likewise i can do the cosine of theta 2 and so what can i do from these things can i tell which side of the river bank you are think about yes some of dot product of x a and xb is less than xc then we can that is right you can do some you can do some things to tell because you have all the information you need to tell which side are you on are you on one side or the other side right now it takes a little while to realize that in you have instead of getting the actual equation and distance from the decision boundary you could actually just look at the inner products there was a very lovely intuition i had which is escaping me, where I could illustrate these two things. Okay, so here's the thing. Suppose you have a point, a line, imagine a line, right? And you give, I tell you, and let's say that this is a vector, the line has a unit vector u right and i tell you that you so let me just make it simple or beta naught suppose i tell you that some point could only, and let me say that just for illustration, that it is this. Every point, think of every point here. What can you say about all of these points? Each of these points, let me just call them x. Would you agree that x is the same quantity, which will actually be, we did this, but it will be a constant. Why? Because look at all of these points. Suppose you have a theta here, theta 1, theta 2. If you look at the triangles, let's see this triangle that you look at, this theta, right? This is x. This point is special. Let me just call it x0, the base of the triangle where it meets 90 degrees. Now observe something very interesting. This is x0, a vector X naught. And the beta is pointing along this direction. Would you all agree that no matter which point you choose in this line, X dot beta naught is nothing but the base of the triangle. That is the meaning literally of cosine, because this is equal to magnitude of x which is the hypotenuse what is the magnitude of beta hat this is x the magnitude of the beta vector beta hat vector is one so cosine theta so what is hypotenuse cosine theta in a right angle triangle it's just the base right in a triangle basic definition is if this is theta this is the hypotenuse this is the base and this is the side cosine Theta's dev by definition is is base over hypotenuse right so hypotenuse cosine Theta is the base always the base of the triangle so the base remains the same so if I tell you that x dot Beta hat is some value you realize that you have it could be any point along this line x could be any point along this line am i making sense right so in a way you could you could argue that if i know one thing it constrains me this constrains me lines. Well, if you are given three lines, right, or here, you can pretty much figure out that there is not many degrees of freedom left. At the end of it, you'll be able to tell where this point x is, right? In fact, two may be enough to tell where that point x is. So that is the basic intuition, that instead of drawing the decision boundary, you could just give the inner products. By the way, this is a bit of a hand-waving argument, but I wanted to give you the intuition that it's an irremarkable fact that the same information you can give as a set of inner products, right? The inner products of the point with the support vectors contains essentially the same information to help you determine where exactly this point is and that is actually the intuition that we will use to build kernels we'll come to that later. Now, let us go through and say, okay, we learned about something called the maximal margin hyperplane. But now let's go back to our intuition and say, hey, no, wait a minute. Let me just soften it up a little bit. Data. I have a question. Go ahead, Pradeep. So earlier, the one you were explaining. So if I multiply x with I basically take the dot product right so x x x a and then x b and x c. So if the value remains largely to one support vector, right, quantity of one support vector, so that means it is on that side of the riverbank? That is right. Basically, what happens is, there's more to it. By the way, I did a very hand-waving argument. I will write up a data science notebook in which i'll explain more on it i'm in a bit of a hurry so the real statement is that if you look at the dot product matrix right of x a x x a x b x c x x a x b x c all of these dot products put together they contain the entire information needed to know where is x right and this is a it's a fact that is true but it's non-intuitive we never think like that but pradeep that is it i see but one has to multiply get the dot product without even if the value is nearer, it will be misled. That's right. And so the whole question is, why, I mean, isn't it computationally intensive to get the dot products, right? Generally, when you make linear classifiers, you don't think in terms of dot products. You go directly and draw the decision boundary, right? Beta naught, beta one, beta two. so why in the world suddenly we are we are getting into this mysterious business of dark products i will come to that i've just planted an idea in your mind so that is our destination but i'll get on a train but there is a halfway station here let's go to the halfway station suppose i have my trees. So guys, maximal margin hyperplane, maximal margin classifiers is hopefully clear. Anyone who feels that it is not clear, it's very simple. Just put the widest river through it and the median of the river is your decision boundary. The point is that the river banks are here, those lighthouses on the river banks are the support vectors. Sir, can I ask one more question? Yeah. So this classifier is based on the assumption that the data can be divided into two parts or more. Absolutely. And you hit upon where I'm going Pradeep. Hold that thought. Okay. Okay. more absolutely and you hit upon where i'm going pradip hold that thought okay okay